import{_ as o,r as l,o as p,c as t,a as s,b as a,d as c,e}from"./app.f0c7c707.js";const r={},i=e(`<h1 id="create-read-update-delete" tabindex="-1"><a class="header-anchor" href="#create-read-update-delete" aria-hidden="true">#</a> Create, Read, Update, Delete</h1><p>When you have your collections defined, learn how to manipulate them!</p><h2 id="opening-isar" tabindex="-1"><a class="header-anchor" href="#opening-isar" aria-hidden="true">#</a> Opening Isar</h2><p>Before you can do anything, we need an Isar instance. Each instance requires a directory with write permission where the database file can be stored. If you don&#39;t specify a directory, Isar will find a suitable default directory for the current platform.</p><p>Provide all the schemas you want to use with the Isar instance. If you open multiple instances, you still have to provide the same schemas to each instance.</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> isar </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Isar</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">open</span><span style="color:#ABB2BF;">([</span><span style="color:#E5C07B;">RecipeSchema</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"></span></code></pre></div><p>You can use the default config or provide some of the following parameters:</p><table><thead><tr><th>Config</th><th>Description</th></tr></thead><tbody><tr><td><code>name</code></td><td>Open multiple instances with distinct names. By default, <code>&quot;default&quot;</code> is used.</td></tr><tr><td><code>directory</code></td><td>The storage location for this instance. By default, <code>NSDocumentDirectory</code> is used for iOS and <code>getDataDirectory</code> for Android. Not required for web.</td></tr><tr><td><code>maxSizeMib</code></td><td>The maximum size of the database file in MiB. Isar uses virtual memory which is not an endless resource so be mindful with the value here. If you open multiple instances they share the available virtual memory so each instance should have a smaller <code>maxSizeMib</code> . The default is 2048.</td></tr><tr><td><code>relaxedDurability</code></td><td>Relaxes the durability guarantee to increase write performance. In case of a system crash (not app crash), it is possible to lose the last committed transaction. Corruption is not possible</td></tr><tr><td><code>compactOnLaunch</code></td><td>Conditions to check whether the database should be compacted when the instance is opened.</td></tr><tr><td><code>inspector</code></td><td>Enabled the Inspector for debug builds. For profile and release builds this option is ignored.</td></tr></tbody></table><p>If an instance is already open, calling <code>Isar.open()</code> will yield the existing instance regardless of the specified parameters. That&#39;s useful for using Isar in an isolate.</p>`,9),B={class:"custom-container tip"},d=s("p",{class:"custom-container-title"},"Tip",-1),y={href:"https://pub.dev/packages/path_provider",target:"_blank",rel:"noopener noreferrer"},F=e(`<p>The storage location of the database file is <code>directory/name.isar</code></p><h2 id="reading-from-the-database" tabindex="-1"><a class="header-anchor" href="#reading-from-the-database" aria-hidden="true">#</a> Reading from the database</h2><p>Use <code>IsarCollection</code> instances to find, query, and create new objects of a given type in Isar.</p><p>For the examples below, we assume that we have a collection <code>Recipe</code> defined as follows:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">@collection</span></span>
<span class="line"><span style="color:#C678DD;">class</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Recipe</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">Id</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">String</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> name;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">DateTime</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> lastCooked;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#E5C07B;">bool</span><span style="color:#C678DD;">?</span><span style="color:#ABB2BF;"> isFavorite;</span></span>
<span class="line"><span style="color:#ABB2BF;">}</span></span>
<span class="line"></span></code></pre></div><h3 id="get-a-collection" tabindex="-1"><a class="header-anchor" href="#get-a-collection" aria-hidden="true">#</a> Get a collection</h3><p>All your collections live in the Isar instance. You can get the recipes collection with:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> recipes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> isar.recipes;</span></span>
<span class="line"></span></code></pre></div><p>That was easy! If you don&#39;t want to use collection accessors, you can also use the <code>collection()</code> method:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> recipes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">collection</span><span style="color:#ABB2BF;">&lt;</span><span style="color:#E5C07B;">Recipe</span><span style="color:#ABB2BF;">&gt;();</span></span>
<span class="line"></span></code></pre></div><h3 id="get-an-object-by-id" tabindex="-1"><a class="header-anchor" href="#get-an-object-by-id" aria-hidden="true">#</a> Get an object (by id)</h3><p>We don&#39;t have data in the collection yet but let&#39;s pretend we do so we can get an imaginary object by the id <code>123</code></p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> recipe </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#C678DD;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre></div><p><code>get()</code> returns a <code>Future</code> with either the object or <code>null</code> if it does not exist. All Isar operations are asynchronous by default, and most of them have a synchronous counterpart:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> recipe </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">getSync</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"></span></code></pre></div><div class="custom-container warning"><p class="custom-container-title">Warning</p><p>You should default to the asynchronous version of methods in your UI isolate. Since Isar is very fast, it is often acceptable to use the synchronous version.</p></div><p>If you want to get multiple objects at once, use <code>getAll()</code> or <code>getAllSync()</code>:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> recipe </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">getAll</span><span style="color:#ABB2BF;">([</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"></span></code></pre></div><h3 id="query-objects" tabindex="-1"><a class="header-anchor" href="#query-objects" aria-hidden="true">#</a> Query objects</h3><p>Instead of getting objects by id you can also query a list of objects matching certain conditions using <code>.where()</code> and <code>.filter()</code>:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> allRecipes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">where</span><span style="color:#ABB2BF;">().</span><span style="color:#61AFEF;">findAll</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> favouires </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">filter</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">  .</span><span style="color:#61AFEF;">isFavoriteEqualTo</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">  .</span><span style="color:#61AFEF;">findAll</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"></span></code></pre></div><p>➡️ Learn more: <a href="queries">Queries</a></p><h2 id="modifying-the-database" tabindex="-1"><a class="header-anchor" href="#modifying-the-database" aria-hidden="true">#</a> Modifying the database</h2><p>It&#39;s finally time to modify our collection! To create, update, or delete objects, use the respective operations wrapped in a write transaction:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">writeTxn</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> recipe </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#C678DD;">get</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  recipe.isFavorite </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(recipe); </span><span style="color:#7F848E;">// perform update operations</span></span>
<span class="line"></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">delete</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">); </span><span style="color:#7F848E;">// or delete operations</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span></code></pre></div><p>➡️ Learn more: <a href="transactions">Transactions</a></p><h3 id="insert-object" tabindex="-1"><a class="header-anchor" href="#insert-object" aria-hidden="true">#</a> Insert object</h3><p>To persist an object in Isar, insert it into a collection. Isar&#39;s <code>put()</code> method will either insert or update the object depending on whether it already exists in the collection.</p><p>If the id field is <code>null</code> or <code>Isar.autoIncrement</code>, Isar will use an auto-increment id.</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> pancakes </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">Recipe</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">  ..name </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#98C379;">&#39;Pancakes&#39;</span></span>
<span class="line"><span style="color:#ABB2BF;">  ..lastCooked </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#E5C07B;">DateTime</span><span style="color:#ABB2BF;">.</span><span style="color:#61AFEF;">now</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">  ..isFavorite </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">true</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">writeTxn</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(pancakes);</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span>
<span class="line"></span></code></pre></div><p>Isar will automatically assign the id to the object if the <code>id</code> field is non-final.</p><p>Inserting multiple objects at once is just as easy:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">writeTxn</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">putAll</span><span style="color:#ABB2BF;">([pancakes, pizza]);</span></span>
<span class="line"><span style="color:#ABB2BF;">})</span></span>
<span class="line"></span></code></pre></div><h3 id="update-object" tabindex="-1"><a class="header-anchor" href="#update-object" aria-hidden="true">#</a> Update object</h3><p>Both creating and updating works with <code>collection.put(object)</code>. If the id is <code>null</code> (or does not exist), the object is inserted; otherwise, it is updated.</p><p>So if we want to unfavorite our pancakes, we can do the following:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">writeTxn</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  pancakes.isFavorite </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">;</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">put</span><span style="color:#ABB2BF;">(pancakes);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span></code></pre></div><h3 id="delete-object" tabindex="-1"><a class="header-anchor" href="#delete-object" aria-hidden="true">#</a> Delete object</h3><p>Want to get rid of an object in Isar? Use <code>collection.delete(id)</code>. The delete method returns whether an object with the specified id was found and deleted. If you want to delete the object with id <code>123</code>, for example, you can do:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">writeTxn</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> success </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">delete</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">123</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;Recipe deleted: $</span><span style="color:#E06C75;">success</span><span style="color:#98C379;">&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span></code></pre></div><p>Similarly to get and put, there is also a bulk delete operation that returns the number of deleted objects:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">writeTxn</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> count </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">deleteAll</span><span style="color:#ABB2BF;">([</span><span style="color:#D19A66;">1</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">2</span><span style="color:#ABB2BF;">, </span><span style="color:#D19A66;">3</span><span style="color:#ABB2BF;">]);</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;We deleted $</span><span style="color:#E06C75;">count</span><span style="color:#98C379;"> recipes&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span></code></pre></div><p>If you don&#39;t know the ids of the objects you want to delete, you can use a query:</p><div class="language-dart" data-ext="dart"><pre class="shiki" style="background-color:#282c34;"><code><span class="line"><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.</span><span style="color:#61AFEF;">writeTxn</span><span style="color:#ABB2BF;">(() </span><span style="color:#C678DD;">async</span><span style="color:#ABB2BF;"> {</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#C678DD;">final</span><span style="color:#ABB2BF;"> count </span><span style="color:#56B6C2;">=</span><span style="color:#ABB2BF;"> </span><span style="color:#C678DD;">await</span><span style="color:#ABB2BF;"> isar.recipes.</span><span style="color:#61AFEF;">filter</span><span style="color:#ABB2BF;">()</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">isFavoriteEqualTo</span><span style="color:#ABB2BF;">(</span><span style="color:#D19A66;">false</span><span style="color:#ABB2BF;">)</span></span>
<span class="line"><span style="color:#ABB2BF;">    .</span><span style="color:#61AFEF;">deleteAll</span><span style="color:#ABB2BF;">();</span></span>
<span class="line"><span style="color:#ABB2BF;">  </span><span style="color:#61AFEF;">print</span><span style="color:#ABB2BF;">(</span><span style="color:#98C379;">&#39;We deleted $</span><span style="color:#E06C75;">count</span><span style="color:#98C379;"> recipes&#39;</span><span style="color:#ABB2BF;">);</span></span>
<span class="line"><span style="color:#ABB2BF;">});</span></span>
<span class="line"></span></code></pre></div>`,44);function h(A,u){const n=l("ExternalLinkIcon");return p(),t("div",null,[i,s("div",B,[d,s("p",null,[a("Consider using the "),s("a",y,[a("path_provider"),c(n)]),a(" package to get a valid path on all platforms.")])]),F])}const D=o(r,[["render",h],["__file","crud.html.vue"]]);export{D as default};
